(()=>{"use strict";class e{constructor(e){this.value=e,this.next=null}}class t{constructor(){this.head=null,this.tail=null}append(t){const s=new e(t);this.head?(this.tail.next=s,this.tail=s):(this.head=s,this.tail=s)}prepend(t){const s=new e(t);this.head?(s.next=this.head,this.head=s):(this.head=s,this.tail=s)}size(){let e=0,t=this.head;for(;!this.head;)e++,t=t.next;return e}at(e){if(e<0)return null;if(this.head){let t=this.head,s=0;for(;s<e;)s++,t=t.next;return t||null}}pop(){if(!this.tail)return console.log("No item to pop"),null;const e=this.tail.value;if(this.head===this.tail)return this.head=null,this.tail=null,e;let t=this.head;for(;t.next!==this.tail;)t=t.next;return t.next=null,this.tail=t,e}contains(e){let t=this.head;for(;null!==t.next;){if(t.value===e)return!0;t=t.next}return!1}find(e){let t=this.head,s=0;for(;t;){if(t.value===e)return s;t=t.next,s++}return-1}toString(){let e="";if(this.head){let t=this.head;for(;t;){if(null===t.next)return e+"null";e+=`( ${t.value} ) -> `,t=t.next}return e}return null}insertAt(t,s){if(s<0)return null;const n=new e(t);if(0===s)return n.next=this.head,this.head=n,this.tail||(this.tail=n),!0;let l=this.head,h=0;for(;l&&h<s-1;)l=l.next,h++;return!!l&&(n.next=l.next,l.next=n,n.next||(this.tail=n),!0)}removeAt(e){if(e<0||!this.head)return null;if(0===e){const e=this.head.value;return this.head=this.head.next,this.head||(this.tail=null),e}let t=this.head,s=0;for(;t.next&&s<e-1;)t=t.next,s++;if(!t.next)return null;const n=t.next.value;return t.next=t.next.next,t.next||(this.tail=t),n}}class s{constructor(e=8){this.buckets=new Array(e).fill(null).map((()=>new t)),this.size=0,this.loadFactor=.75}hash(e){let t=0;for(let s=0;s<e.length;s++)t=(31*t+e.charCodeAt(s))%this.buckets.length;return t}set(e,t){let s,n=this.hash(e);if(n<0||n>=this.buckets.length)throw new Error("Trying to access index out of bound");s=this.buckets[n];let l=s.head;for(;l;){if(l.value.key===e)return void(l.value.value=t);l=l.next}s.append({key:e,value:t}),this.size++,this.size/this.buckets.length>this.loadFactor&&(this.resize(),console.log("resized hashmap"))}get(e){let t,s=this.hash(e);if(s<0||s>=this.buckets.length)throw new Error("Trying to access index out of bound");t=this.buckets[s];let n=t.head;for(;n;){if(n.value.key===e)return n.value.value;n=n.next}return"Not found"}has(e){let t,s=this.hash(e);if(s<0||s>=this.buckets.length)throw new Error("Trying to access index out of bound");t=this.buckets[s];let n=t.head;for(;n;){if(n.value.key===e)return!0;n=n.next}return!1}remove(e){let t,s=this.hash(e);if(s<0||s>=this.buckets.length)throw new Error("Trying to access index out of bound");t=this.buckets[s];let n=t.head,l=null;for(;n;){if(n.value.key===e)return l?l.next=n.next:t.head=n.next,n===t.tail&&(t.tail=l),this.size--,n.value.value;l=n,n=n.next}return null}length(){return this.size()}clear(){this.buckets=new Array(this.buckets.length).fill(null).map((()=>new t)),this.size=0}keys(){const e=[];for(let t of this.buckets){let s=t.head;for(;s;)e.push(s.value.key),s=s.next}return e}values(){const e=[];for(let t of this.buckets){let s=t.head;for(;s;)e.push(s.value.value),s=s.next}return e}entries(){const e=[];for(let t of this.buckets){let s=t.head;for(;s;){const t=[s.value.key,s.value.value];e.push(t),s=s.next}}return e}resize(){const e=2*this.buckets.length,s=new Array(e).fill(null).map((()=>new t));for(let e of this.buckets){let t=e.head;for(;t;)s[this.hash(t.value.key)].append(t.value),t=t.next}this.buckets=s}}const n=new s;console.log(n.hash("Yorkshire")),console.log(n.hash("Yorkshire")),console.log(n.hash("Center")),console.log(n.hash("center")),console.log(n.hash("CENTER")),n.set("Joe24235","@mogus"),console.log(n.get("Joe24235")),console.log(n.has("Joe24235")),function(){const e=new s;e.set("apple","red"),e.set("banana","yellow"),e.set("carrot","orange"),e.set("dog","brown"),e.set("elephant","gray"),e.set("frog","green"),e.set("frog","blue"),e.set("grape","purple"),e.set("hat","black"),e.set("ice cream","white"),e.set("jacket","blue"),e.set("kite","pink"),e.set("lion","golden"),e.set("moon","silver"),console.log(e.entries())}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixJQUFJLFNBQVUsVUFDbkJvQixFQUFLcEIsSUFBSSxTQUFVLFVBQ25Cb0IsRUFBS3BCLElBQUksTUFBTyxTQUNoQm9CLEVBQUtwQixJQUFJLFdBQVksUUFDckJvQixFQUFLcEIsSUFBSSxPQUFRLFNBQ2pCb0IsRUFBS3BCLElBQUksT0FBUSxRQUNqQm9CLEVBQUtwQixJQUFJLFFBQVMsVUFDbEJvQixFQUFLcEIsSUFBSSxNQUFPLFNBQ2hCb0IsRUFBS3BCLElBQUksWUFBYSxTQUN0Qm9CLEVBQUtwQixJQUFJLFNBQVUsUUFDbkJvQixFQUFLcEIsSUFBSSxPQUFRLFFBQ2pCb0IsRUFBS3BCLElBQUksT0FBUSxVQUNqQm9CLEVBQUtwQixJQUFJLE9BQVEsVUFFakJ0QixRQUFRQyxJQUFJeUMsRUFBS04sVUFDckIsQ0RMQU0sRSIsInNvdXJjZXMiOlsid2VicGFjazovL2FwaWRlbW8vLi9zcmMvbGlua2VkTGlzdC5qcyIsIndlYnBhY2s6Ly9hcGlkZW1vLy4vc3JjL2hhc2hNYXAuanMiLCJ3ZWJwYWNrOi8vYXBpZGVtby8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcGlkZW1vLy4vc3JjL3Rlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIE5vZGUge1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKXtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIExpbmtlZExpc3Qge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmhlYWQgPSBudWxsO1xuICAgICAgICB0aGlzLnRhaWwgPSBudWxsO1xuICAgIH1cblxuICAgIGFwcGVuZCh2YWx1ZSkge1xuICAgICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUodmFsdWUpO1xuICAgICAgICBpZighdGhpcy5oZWFkKXtcbiAgICAgICAgICAgIC8vIElmIHRoZSBsaXN0IGlzIG51bGwvZW1wdHksIHRoZSBuZXcgbm9kZSBpcyBib3RoIHRoZSBoZWFkIGFuZCB0YWlsXG4gICAgICAgICAgICB0aGlzLmhlYWQgPSBuZXdOb2RlO1xuICAgICAgICAgICAgdGhpcy50YWlsID0gbmV3Tm9kZTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgdGhpcy50YWlsLm5leHQgPSBuZXdOb2RlO1xuICAgICAgICAgICAgdGhpcy50YWlsID0gbmV3Tm9kZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByZXBlbmQodmFsdWUpIHtcbiAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcbiAgICAgICAgaWYoIXRoaXMuaGVhZCkge1xuICAgICAgICAgICAgdGhpcy5oZWFkID0gbmV3Tm9kZTtcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IG5ld05vZGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdOb2RlLm5leHQgPSB0aGlzLmhlYWQ7XG4gICAgICAgICAgICB0aGlzLmhlYWQgPSBuZXdOb2RlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2l6ZSgpe1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgd2hpbGUoIXRoaXMuaGVhZCl7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuXG4gICAgLy8gaGVhZCgpe1xuICAgIC8vICAgICBpZih0aGlzLmhlYWQpe1xuICAgIC8vICAgICAgICAgY29uc3QgaGVhZE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgLy8gICAgICAgICByZXR1cm4gaGVhZE5vZGU7XG4gICAgLy8gICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAvLyAgICAgfVxuICAgIC8vIH1cblxuICAgIC8vIHRhaWwoKXtcbiAgICAvLyAgICAgaWYodGhpcy50YWlsKXtcbiAgICAvLyAgICAgICAgIGNvbnN0IHRhaWxOb2RlID0gdGhpcy50YWlsO1xuICAgIC8vICAgICAgICAgcmV0dXJuIHRhaWxOb2RlO1xuICAgIC8vICAgICB9IGVsc2Uge1xuICAgIC8vICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG5cbiAgICBhdChpbmRleCl7XG4gICAgICAgIGlmIChpbmRleCA8IDApIHJldHVybiBudWxsOyAvLyBJbmRleCBzaG91bGQgYmUgbm9uLW5lZ2F0aXZlXG4gICAgICAgIGlmKHRoaXMuaGVhZCkge1xuICAgICAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICAgICAgd2hpbGUoaSA8IGluZGV4KXtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlID8gY3VycmVudE5vZGUgOiBudWxsOyAvLyBSZXR1cm4gdGhlIG5vZGUgaWYgZm91bmQsIGVsc2UgbnVsbFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcG9wKCl7XG4gICAgICAgIGlmICghdGhpcy50YWlsKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vIGl0ZW0gdG8gcG9wXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwb3BwZWRWYWx1ZSA9IHRoaXMudGFpbC52YWx1ZTtcblxuICAgICAgICBpZiAodGhpcy5oZWFkID09PSB0aGlzLnRhaWwpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgb25seSBvbmUgbm9kZSBpbiB0aGUgbGlzdFxuICAgICAgICAgICAgdGhpcy5oZWFkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gcG9wcGVkVmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgIHdoaWxlKGN1cnJlbnROb2RlLm5leHQgIT09IHRoaXMudGFpbCl7XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm93IGN1cnJlbnROb2RlIGlzIHRoZSBzZWNvbmQtdG8tbGFzdCBub2RlXG4gICAgICAgIGN1cnJlbnROb2RlLm5leHQgPSBudWxsO1xuICAgICAgICB0aGlzLnRhaWwgPSBjdXJyZW50Tm9kZTtcblxuICAgICAgICByZXR1cm4gcG9wcGVkVmFsdWU7XG4gICAgfVxuXG4gICAgY29udGFpbnModmFsdWUpIHtcbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICB3aGlsZShjdXJyZW50Tm9kZS5uZXh0ICE9PSBudWxsKXtcbiAgICAgICAgICAgIGlmKGN1cnJlbnROb2RlLnZhbHVlID09PSB2YWx1ZSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZmluZCh2YWx1ZSkge1xuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgd2hpbGUoY3VycmVudE5vZGUpe1xuICAgICAgICAgICAgaWYoY3VycmVudE5vZGUudmFsdWUgPT09IHZhbHVlKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuXG4gICAgdG9TdHJpbmcoKXtcbiAgICAgICAgbGV0IG91dHB1dCA9IFwiXCJcbiAgICAgICAgaWYoIXRoaXMuaGVhZCl7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgICAgIHdoaWxlKGN1cnJlbnROb2RlKXtcbiAgICAgICAgICAgICAgICBpZihjdXJyZW50Tm9kZS5uZXh0ID09PSBudWxsKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dCArPSBcIm51bGxcIiA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9IGAoICR7Y3VycmVudE5vZGUudmFsdWV9ICkgLT4gYDtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluc2VydEF0KHZhbHVlLCBpbmRleCl7XG4gICAgICAgIGlmIChpbmRleCA8IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAvLyBJbnNlcnQgYXQgdGhlIGhlYWRcbiAgICAgICAgICAgIG5ld05vZGUubmV4dCA9IHRoaXMuaGVhZDtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IG5ld05vZGU7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGFpbCkge1xuICAgICAgICAgICAgICAvLyBJZiB0aGUgbGlzdCB3YXMgZW1wdHksIHVwZGF0ZSB0aGUgdGFpbCBhcyB3ZWxsXG4gICAgICAgICAgICAgIHRoaXMudGFpbCA9IG5ld05vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgbGV0IGkgPSAwO1xuXG4gICAgICAgIHdoaWxlIChjdXJyZW50Tm9kZSAmJiBpIDwgaW5kZXggLSAxKSB7XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWN1cnJlbnROb2RlKSByZXR1cm4gZmFsc2U7IC8vIEluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAgICAgICAgXG4gICAgICAgIG5ld05vZGUubmV4dCA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgIGN1cnJlbnROb2RlLm5leHQgPSBuZXdOb2RlO1xuICAgIFxuICAgICAgICBpZiAoIW5ld05vZGUubmV4dCkge1xuICAgICAgICAgIC8vIElmIHRoZSBuZXcgbm9kZSBpcyBpbnNlcnRlZCBhdCB0aGUgZW5kLCB1cGRhdGUgdGhlIHRhaWxcbiAgICAgICAgICB0aGlzLnRhaWwgPSBuZXdOb2RlO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgLy8gTWV0aG9kIHRvIHJlbW92ZSBhIG5vZGUgYXQgYSBzcGVjaWZpYyBpbmRleFxuICAgIHJlbW92ZUF0KGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA8IDAgfHwgIXRoaXMuaGVhZCkgcmV0dXJuIG51bGw7IC8vIEluZGV4IGlzIGludmFsaWQgb3IgbGlzdCBpcyBlbXB0eVxuXG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBoZWFkIG5vZGVcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZWRWYWx1ZSA9IHRoaXMuaGVhZC52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IHRoaXMuaGVhZC5uZXh0O1xuICAgICAgICAgICAgaWYgKCF0aGlzLmhlYWQpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbGlzdCBiZWNvbWVzIGVtcHR5LCB1cGRhdGUgdGhlIHRhaWxcbiAgICAgICAgICAgICAgICB0aGlzLnRhaWwgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZWRWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgbGV0IGkgPSAwO1xuXG4gICAgICAgIHdoaWxlIChjdXJyZW50Tm9kZS5uZXh0ICYmIGkgPCBpbmRleCAtIDEpIHtcbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY3VycmVudE5vZGUubmV4dCkgcmV0dXJuIG51bGw7IC8vIEluZGV4IGlzIG91dCBvZiBib3VuZHNcblxuICAgICAgICBjb25zdCByZW1vdmVkVmFsdWUgPSBjdXJyZW50Tm9kZS5uZXh0LnZhbHVlO1xuICAgICAgICBjdXJyZW50Tm9kZS5uZXh0ID0gY3VycmVudE5vZGUubmV4dC5uZXh0O1xuXG4gICAgICAgIGlmICghY3VycmVudE5vZGUubmV4dCkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIHJlbW92ZWQgbm9kZSB3YXMgdGhlIHRhaWwsIHVwZGF0ZSB0aGUgdGFpbFxuICAgICAgICAgICAgdGhpcy50YWlsID0gY3VycmVudE5vZGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVtb3ZlZFZhbHVlO1xuICAgIH1cbn1cblxuLy8gRXhhbXBsZSB1c2FnZTpcbi8vIGNvbnN0IGxpc3QgPSBuZXcgTGlua2VkTGlzdCgpO1xuLy8gbGlzdC5hcHBlbmQoMSk7XG4vLyBsaXN0LmFwcGVuZCgyKTtcbi8vIGxpc3QuYXBwZW5kKDMpO1xuLy8gbGlzdC5wcmVwZW5kKDApO1xuXG4vLyBsaXN0Lmluc2VydEF0KDEuNSwgMik7XG4vLyBjb25zb2xlLmxvZygnTGlua2VkTGlzdDonLCBsaXN0LnRvU3RyaW5nKCkpOyAvLyBPdXRwdXQ6ICggMCApIC0+ICggMSApIC0+ICggMS41ICkgLT4gKCAyICkgLT4gKCAzICkgLT4gbnVsbFxuXG4vLyBsaXN0LnJlbW92ZUF0KDIpO1xuLy8gY29uc29sZS5sb2coJ0xpbmtlZExpc3QgYWZ0ZXIgcmVtb3ZhbDonLCBsaXN0LnRvU3RyaW5nKCkpOyAvLyBPdXRwdXQ6ICggMCApIC0+ICggMSApIC0+ICggMiApIC0+ICggMyApIC0+IG51bGxcblxuLy8gbGlzdC5yZW1vdmVBdCgwKTtcbi8vIGNvbnNvbGUubG9nKCdMaW5rZWRMaXN0IGFmdGVyIHJlbW92aW5nIGhlYWQ6JywgbGlzdC50b1N0cmluZygpKTsgLy8gT3V0cHV0OiAoIDEgKSAtPiAoIDIgKSAtPiAoIDMgKSAtPiBudWxsXG5cbi8vIGxpc3QucmVtb3ZlQXQoMik7XG4vLyBjb25zb2xlLmxvZygnTGlua2VkTGlzdCBhZnRlciByZW1vdmluZyB0YWlsOicsIGxpc3QudG9TdHJpbmcoKSk7IC8vIE91dHB1dDogKCAxICkgLT4gKCAyICkgLT4gbnVsbCIsImltcG9ydCB7IExpbmtlZExpc3QsIE5vZGUgfSBmcm9tIFwiLi9saW5rZWRMaXN0XCI7XG5cbi8vaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1INjJKZnYxREpsVVxuZXhwb3J0IGNsYXNzIEhhc2hNYXAge1xuICAgIGNvbnN0cnVjdG9yKGNhcGFjaXR5ID0gOCkge1xuICAgICAgICB0aGlzLmJ1Y2tldHMgPSBuZXcgQXJyYXkoY2FwYWNpdHkpLmZpbGwobnVsbCkubWFwKCgpID0+IG5ldyBMaW5rZWRMaXN0KCkpOyBcbiAgICAgICAgLy9tYXAoKCkgPT4gbmV3IExpbmtlZExpc3QoKSBUcmFuc2Zvcm1zIGVhY2ggbnVsbCB2YWx1ZSBpbnRvIGFuIGVtcHR5IGxpbmtlZCBsaXN0LlxuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgICAgICB0aGlzLmxvYWRGYWN0b3IgPSAwLjc1O1xuICAgIH1cbiAgXG4gICAgLy8gSGFzaCBmdW5jdGlvblxuICAgIGhhc2goa2V5KSB7XG4gICAgICAgIGxldCBoYXNoQ29kZSA9IDA7XG4gICAgICAgIGNvbnN0IHByaW1lTnVtYmVyID0gMzE7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBoYXNoQ29kZSA9IChwcmltZU51bWJlciAqIGhhc2hDb2RlICsga2V5LmNoYXJDb2RlQXQoaSkpICUgdGhpcy5idWNrZXRzLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGFzaENvZGU7XG4gICAgfVxuXG4gICAgc2V0KGtleSwgdmFsdWUpe1xuICAgICAgICBsZXQgaGFzaENvZGUgPSB0aGlzLmhhc2goa2V5KTtcbiAgICAgICAgbGV0IGJ1Y2tldDtcbiAgICAgICAgaWYgKGhhc2hDb2RlIDwgMCB8fCBoYXNoQ29kZSA+PSB0aGlzLmJ1Y2tldHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcnlpbmcgdG8gYWNjZXNzIGluZGV4IG91dCBvZiBib3VuZFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1Y2tldCA9IHRoaXMuYnVja2V0c1toYXNoQ29kZV07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUga2V5IGFscmVhZHkgZXhpc3RzIGluIHRoZSBidWNrZXRcbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gYnVja2V0LmhlYWQ7XG4gICAgICAgIHdoaWxlIChjdXJyZW50Tm9kZSkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlLnZhbHVlLmtleSA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUudmFsdWUudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGJ1Y2tldC5hcHBlbmQoeyBrZXksIHZhbHVlIH0pO1xuICAgICAgICB0aGlzLnNpemUrKztcblxuICAgICAgICAvLyBSZXNpemUgaWYgbG9hZCBmYWN0b3IgaXMgZXhjZWVkZWRcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAvIHRoaXMuYnVja2V0cy5sZW5ndGggPiB0aGlzLmxvYWRGYWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMucmVzaXplKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInJlc2l6ZWQgaGFzaG1hcFwiKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0KGtleSl7XG4gICAgICAgIGxldCBoYXNoQ29kZSA9IHRoaXMuaGFzaChrZXkpO1xuICAgICAgICBsZXQgYnVja2V0O1xuICAgICAgICBpZiAoaGFzaENvZGUgPCAwIHx8IGhhc2hDb2RlID49IHRoaXMuYnVja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVja2V0ID0gdGhpcy5idWNrZXRzW2hhc2hDb2RlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IGJ1Y2tldC5oZWFkO1xuICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50Tm9kZS52YWx1ZS5rZXkgPT09IGtleSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50Tm9kZS52YWx1ZS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBcIk5vdCBmb3VuZFwiO1xuICAgIH1cblxuICAgIGhhcyhrZXkpe1xuICAgICAgICBsZXQgaGFzaENvZGUgPSB0aGlzLmhhc2goa2V5KTtcbiAgICAgICAgbGV0IGJ1Y2tldDtcbiAgICAgICAgaWYgKGhhc2hDb2RlIDwgMCB8fCBoYXNoQ29kZSA+PSB0aGlzLmJ1Y2tldHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcnlpbmcgdG8gYWNjZXNzIGluZGV4IG91dCBvZiBib3VuZFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1Y2tldCA9IHRoaXMuYnVja2V0c1toYXNoQ29kZV07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudE5vZGUudmFsdWUua2V5ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmVtb3ZlKGtleSkge1xuICAgICAgICBsZXQgaGFzaENvZGUgPSB0aGlzLmhhc2goa2V5KTtcbiAgICAgICAgbGV0IGJ1Y2tldDtcbiAgICAgICAgaWYgKGhhc2hDb2RlIDwgMCB8fCBoYXNoQ29kZSA+PSB0aGlzLmJ1Y2tldHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcnlpbmcgdG8gYWNjZXNzIGluZGV4IG91dCBvZiBib3VuZFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1Y2tldCA9IHRoaXMuYnVja2V0c1toYXNoQ29kZV07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgbGV0IHByZXZpb3VzTm9kZSA9IG51bGw7XG5cbiAgICAgICAgd2hpbGUoY3VycmVudE5vZGUpIHtcbiAgICAgICAgICAgIGlmKGN1cnJlbnROb2RlLnZhbHVlLmtleSA9PT0ga2V5KXtcbiAgICAgICAgICAgICAgICBpZihwcmV2aW91c05vZGUpe1xuICAgICAgICAgICAgICAgICAgICAvL2RlbGV0ZXMgY3VycmVudCBub2RlIGJ5IGJ5cGFzc2luZyBpdFxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c05vZGUubmV4dCA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYnVja2V0LmhlYWQgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBub2RlIGlzIHRoZSB0YWlsLCB1cGRhdGUgdGhlIHRhaWwgcmVmZXJlbmNlXG4gICAgICAgICAgICAgICAgaWYoY3VycmVudE5vZGUgPT09IGJ1Y2tldC50YWlsKXtcbiAgICAgICAgICAgICAgICAgICAgYnVja2V0LnRhaWwgPSBwcmV2aW91c05vZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuc2l6ZS0tO1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50Tm9kZS52YWx1ZS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByZXZpb3VzTm9kZSA9IGN1cnJlbnROb2RlO1xuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vUmV0dXJucyB0aGUgbnVtYmVyIG9mIHN0b3JlZCBrZXlzIGluIHRoZSBoYXNoIG1hcFxuICAgIGxlbmd0aCgpe1xuICAgICAgICByZXR1cm4gdGhpcy5zaXplKCk7XG4gICAgfVxuXG4gICAgY2xlYXIoKXtcbiAgICAgICAgdGhpcy5idWNrZXRzID0gbmV3IEFycmF5KHRoaXMuYnVja2V0cy5sZW5ndGgpLmZpbGwobnVsbCkubWFwKCgpID0+IG5ldyBMaW5rZWRMaXN0KCkpO1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cblxuICAgIGtleXMoKXtcbiAgICAgICAgY29uc3Qga2V5c0FycmF5ID0gW107XG4gICAgICAgIGZvciAobGV0IGJ1Y2tldCBvZiB0aGlzLmJ1Y2tldHMpe1xuICAgICAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gYnVja2V0LmhlYWQ7XG4gICAgICAgICAgICB3aGlsZShjdXJyZW50Tm9kZSl7XG4gICAgICAgICAgICAgICAga2V5c0FycmF5LnB1c2goY3VycmVudE5vZGUudmFsdWUua2V5KTtcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGtleXNBcnJheTtcbiAgICB9XG5cbiAgICB2YWx1ZXMoKXtcbiAgICAgICAgY29uc3QgdmFsdWVzQXJyYXkgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgYnVja2V0IG9mIHRoaXMuYnVja2V0cyl7XG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgICAgIHdoaWxlKGN1cnJlbnROb2RlKXtcbiAgICAgICAgICAgICAgICB2YWx1ZXNBcnJheS5wdXNoKGN1cnJlbnROb2RlLnZhbHVlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlc0FycmF5O1xuICAgIH1cblxuICAgIGVudHJpZXMoKSB7XG4gICAgICAgIGNvbnN0IGVudHJpZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBidWNrZXQgb2YgdGhpcy5idWNrZXRzKSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVBcnJheSA9IFtjdXJyZW50Tm9kZS52YWx1ZS5rZXksIGN1cnJlbnROb2RlLnZhbHVlLnZhbHVlXTtcbiAgICAgICAgICAgICAgICBlbnRyaWVzQXJyYXkucHVzaChub2RlQXJyYXkpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW50cmllc0FycmF5O1xuICAgIH1cbiAgICBcbiAgICByZXNpemUoKSB7XG4gICAgICAgIGNvbnN0IG5ld0NhcGFjaXR5ID0gdGhpcy5idWNrZXRzLmxlbmd0aCAqIDI7XG4gICAgICAgIGNvbnN0IG5ld0J1Y2tldHMgPSBuZXcgQXJyYXkobmV3Q2FwYWNpdHkpLmZpbGwobnVsbCkubWFwKCgpID0+IG5ldyBMaW5rZWRMaXN0KCkpO1xuXG4gICAgICAgIGZvciAobGV0IGJ1Y2tldCBvZiB0aGlzLmJ1Y2tldHMpIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IGJ1Y2tldC5oZWFkO1xuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGFzaENvZGUgPSB0aGlzLmhhc2goY3VycmVudE5vZGUudmFsdWUua2V5KTtcbiAgICAgICAgICAgICAgICBuZXdCdWNrZXRzW2hhc2hDb2RlXS5hcHBlbmQoY3VycmVudE5vZGUudmFsdWUpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYnVja2V0cyA9IG5ld0J1Y2tldHM7XG4gICAgfVxufSIsImltcG9ydCB7IExpbmtlZExpc3QsIE5vZGUgfSBmcm9tIFwiLi9saW5rZWRMaXN0XCI7XG5pbXBvcnQgeyBIYXNoTWFwIH0gZnJvbSBcIi4vaGFzaE1hcFwiXG5pbXBvcnQgeyB0ZXN0IH0gZnJvbSBcIi4vdGVzdFwiXG5cbmNvbnN0IGhhc2htYXAgPSBuZXcgSGFzaE1hcCgpO1xuXG5jb25zb2xlLmxvZyhoYXNobWFwLmhhc2goXCJZb3Jrc2hpcmVcIikpO1xuY29uc29sZS5sb2coaGFzaG1hcC5oYXNoKFwiWW9ya3NoaXJlXCIpKTtcbmNvbnNvbGUubG9nKGhhc2htYXAuaGFzaChcIkNlbnRlclwiKSk7XG5jb25zb2xlLmxvZyhoYXNobWFwLmhhc2goXCJjZW50ZXJcIikpO1xuY29uc29sZS5sb2coaGFzaG1hcC5oYXNoKFwiQ0VOVEVSXCIpKTtcblxuaGFzaG1hcC5zZXQoXCJKb2UyNDIzNVwiLCBcIkBtb2d1c1wiKTtcbmNvbnNvbGUubG9nKGhhc2htYXAuZ2V0KFwiSm9lMjQyMzVcIikpO1xuY29uc29sZS5sb2coaGFzaG1hcC5oYXMoXCJKb2UyNDIzNVwiKSk7XG5cbnRlc3QoKTtcblxuXG4vL2lmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gYnVja2V0cy5sZW5ndGgpIHtcbi8vICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcnlpbmcgdG8gYWNjZXNzIGluZGV4IG91dCBvZiBib3VuZFwiKTtcbi8vIH1cblxuLy8gY2xhc3MgTm9kZSB7XG4vLyAgICAgY29uc3RydWN0b3Ioa2V5LCB2YWx1ZSwgbmV4dCA9IG51bGwpIHtcbi8vICAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG4vLyAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbi8vICAgICAgICAgdGhpcy5uZXh0ID0gbmV4dDtcbi8vICAgICB9XG4vLyB9XG5cbi8vSSBjb3VsZCBwcm9iYWJseSBqdXN0IHJldXNlIHRoZSBsaW5rZWQgbGlzdCBJIG1hZGUgaW4gaHR0cHM6Ly9naXRodWIuY29tL0RyRXBpY28vTGlua2VkTGlzdC9ibG9iL21haW4vc3JjL2luZGV4LmpzIG9uIGEgc2VwYXJhdGUgc2NyaXB0IGZpbGUgXG4vLyBjbGFzcyBMaW5rZWRMaXN0IHtcbi8vICAgICBjb25zdHJ1Y3RvcigpIHtcbi8vICAgICAgICAgdGhpcy5oZWFkID0gbnVsbDtcbi8vICAgICB9XG4gIFxuICAgIC8vIEluc2VydCBhIG5ldyBub2RlIG9yIHVwZGF0ZSBhbiBleGlzdGluZyBub2RlXG4gICAgLy8gaW5zZXJ0KGtleSwgdmFsdWUpIHtcbiAgICAvLyAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgLy8gICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgLy8gICAgICAgICBpZiAobm9kZS5rZXkgPT09IGtleSkge1xuICAgIC8vICAgICAgICAgICAgIG5vZGUudmFsdWUgPSB2YWx1ZTsgLy8gVXBkYXRlIGV4aXN0aW5nIGtleVxuICAgIC8vICAgICAgICAgICAgIHJldHVybjtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIG5vZGUgPSBub2RlLm5leHQ7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKGtleSwgdmFsdWUsIHRoaXMuaGVhZCk7XG4gICAgLy8gICAgIHRoaXMuaGVhZCA9IG5ld05vZGU7IC8vIEluc2VydCBuZXcgbm9kZSBhdCB0aGUgaGVhZFxuICAgIC8vIH1cbiAgXG4gICAgLy8gLy8gRmluZCBhIG5vZGUgYnkga2V5XG4gICAgLy8gZmluZChrZXkpIHtcbiAgICAvLyAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgLy8gICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgLy8gICAgICAgICBpZiAobm9kZS5rZXkgPT09IGtleSkge1xuICAgIC8vICAgICAgICAgICAgIHJldHVybiBub2RlLnZhbHVlO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgbm9kZSA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICByZXR1cm4gbnVsbDtcbiAgICAvLyB9XG4gIFxuICAgIC8vIC8vIENoZWNrIGlmIGEga2V5IGV4aXN0c1xuICAgIC8vIGhhcyhrZXkpIHtcbiAgICAvLyAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgLy8gICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgLy8gICAgICAgICBpZiAobm9kZS5rZXkgPT09IGtleSkge1xuICAgIC8vICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgbm9kZSA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICByZXR1cm4gZmFsc2U7XG4gICAgLy8gfVxuICBcbiAgICAvLyAvLyBSZW1vdmUgYSBub2RlIGJ5IGtleVxuICAgIC8vIHJlbW92ZShrZXkpIHtcbiAgICAvLyAgICAgbGV0IG5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgLy8gICAgIGxldCBwcmV2ID0gbnVsbDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKHByZXYgPT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy5oZWFkID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIHByZXYubmV4dCA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgICBwcmV2ID0gbm9kZTtcbiAgICAvLyAgICAgICAgIG5vZGUgPSBub2RlLm5leHQ7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vIH1cbi8vIH1cblxuIiwiaW1wb3J0IHsgSGFzaE1hcCB9IGZyb20gXCIuL2hhc2hNYXBcIiBcblxuZXhwb3J0IGZ1bmN0aW9uIHRlc3QoKXtcbiAgICBjb25zdCB0ZXN0ID0gbmV3IEhhc2hNYXAoKVxuXG4gICAgdGVzdC5zZXQoJ2FwcGxlJywgJ3JlZCcpXG4gICAgdGVzdC5zZXQoJ2JhbmFuYScsICd5ZWxsb3cnKVxuICAgIHRlc3Quc2V0KCdjYXJyb3QnLCAnb3JhbmdlJylcbiAgICB0ZXN0LnNldCgnZG9nJywgJ2Jyb3duJylcbiAgICB0ZXN0LnNldCgnZWxlcGhhbnQnLCAnZ3JheScpXG4gICAgdGVzdC5zZXQoJ2Zyb2cnLCAnZ3JlZW4nKVxuICAgIHRlc3Quc2V0KCdmcm9nJywgJ2JsdWUnKVxuICAgIHRlc3Quc2V0KCdncmFwZScsICdwdXJwbGUnKVxuICAgIHRlc3Quc2V0KCdoYXQnLCAnYmxhY2snKVxuICAgIHRlc3Quc2V0KCdpY2UgY3JlYW0nLCAnd2hpdGUnKVxuICAgIHRlc3Quc2V0KCdqYWNrZXQnLCAnYmx1ZScpXG4gICAgdGVzdC5zZXQoJ2tpdGUnLCAncGluaycpXG4gICAgdGVzdC5zZXQoJ2xpb24nLCAnZ29sZGVuJylcbiAgICB0ZXN0LnNldCgnbW9vbicsICdzaWx2ZXInKVxuXG4gICAgY29uc29sZS5sb2codGVzdC5lbnRyaWVzKCkpO1xufVxuXG4iXSwibmFtZXMiOlsiTm9kZSIsImNvbnN0cnVjdG9yIiwidmFsdWUiLCJ0aGlzIiwibmV4dCIsIkxpbmtlZExpc3QiLCJoZWFkIiwidGFpbCIsImFwcGVuZCIsIm5ld05vZGUiLCJwcmVwZW5kIiwic2l6ZSIsImkiLCJjdXJyZW50Tm9kZSIsImF0IiwiaW5kZXgiLCJwb3AiLCJjb25zb2xlIiwibG9nIiwicG9wcGVkVmFsdWUiLCJjb250YWlucyIsImZpbmQiLCJ0b1N0cmluZyIsIm91dHB1dCIsImluc2VydEF0IiwicmVtb3ZlQXQiLCJyZW1vdmVkVmFsdWUiLCJIYXNoTWFwIiwiY2FwYWNpdHkiLCJidWNrZXRzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwibG9hZEZhY3RvciIsImhhc2giLCJrZXkiLCJoYXNoQ29kZSIsImxlbmd0aCIsImNoYXJDb2RlQXQiLCJzZXQiLCJidWNrZXQiLCJFcnJvciIsInJlc2l6ZSIsImdldCIsImhhcyIsInJlbW92ZSIsInByZXZpb3VzTm9kZSIsImNsZWFyIiwia2V5cyIsImtleXNBcnJheSIsInB1c2giLCJ2YWx1ZXMiLCJ2YWx1ZXNBcnJheSIsImVudHJpZXMiLCJlbnRyaWVzQXJyYXkiLCJub2RlQXJyYXkiLCJuZXdDYXBhY2l0eSIsIm5ld0J1Y2tldHMiLCJoYXNobWFwIiwidGVzdCJdLCJzb3VyY2VSb290IjoiIn0=