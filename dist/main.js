(()=>{"use strict";class t{constructor(t){this.value=t,this.next=null}}class e{constructor(){this.head=null,this.tail=null}append(e){const n=new t(e);this.head?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n)}prepend(e){const n=new t(e);this.head?(n.next=this.head,this.head=n):(this.head=n,this.tail=n)}size(){let t=0,e=this.head;for(;!this.head;)t++,e=e.next;return t}at(t){if(t<0)return null;if(this.head){let e=this.head,n=0;for(;n<t;)n++,e=e.next;return e||null}}pop(){if(!this.tail)return console.log("No item to pop"),null;const t=this.tail.value;if(this.head===this.tail)return this.head=null,this.tail=null,t;let e=this.head;for(;e.next!==this.tail;)e=e.next;return e.next=null,this.tail=e,t}contains(t){let e=this.head;for(;null!==e.next;){if(e.value===t)return!0;e=e.next}return!1}find(t){let e=this.head,n=0;for(;e;){if(e.value===t)return n;e=e.next,n++}return-1}toString(){let t="";if(this.head){let e=this.head;for(;e;){if(null===e.next)return t+"null";t+=`( ${e.value} ) -> `,e=e.next}return t}return null}insertAt(e,n){if(n<0)return null;const s=new t(e);if(0===n)return s.next=this.head,this.head=s,this.tail||(this.tail=s),!0;let h=this.head,i=0;for(;h&&i<n-1;)h=h.next,i++;return!!h&&(s.next=h.next,h.next=s,s.next||(this.tail=s),!0)}removeAt(t){if(t<0||!this.head)return null;if(0===t){const t=this.head.value;return this.head=this.head.next,this.head||(this.tail=null),t}let e=this.head,n=0;for(;e.next&&n<t-1;)e=e.next,n++;if(!e.next)return null;const s=e.next.value;return e.next=e.next.next,e.next||(this.tail=e),s}}const n=new class{constructor(t=8){this.buckets=new Array(t).fill(null).map((()=>new e)),this.size=0,this.loadFactor=.75}hash(t){let e=0;for(let n=0;n<t.length;n++)e=(31*e+t.charCodeAt(n))%this.buckets.length;return e}set(t,e){let n,s=this.hash(t);if(s<0||s>=buckets.length)throw new Error("Trying to access index out of bound");n=this.buckets[s];let h=n.head;for(;h;){if(h.value.key===t)return void(h.value.value=e);h=h.next}n.append({key:t,value:e}),this.size++,this.size/this.buckets.length>this.loadFactor&&this.resize()}get(t){let e,n=this.hash(t);if(n<0||n>=buckets.length)throw new Error("Trying to access index out of bound");e=this.buckets[n];let s=e.head;for(;s;){if(s.value.key===t)return s.value.value;s=s.next}return"Not found"}has(t){let e,n=this.hash(t);if(n<0||n>=buckets.length)throw new Error("Trying to access index out of bound");e=this.buckets[n];let s=e.head;for(;s;){if(s.value.key===t)return!0;s=s.next}return!1}remove(t){let e,n=this.hash(t);if(n<0||n>=buckets.length)throw new Error("Trying to access index out of bound");e=this.buckets[n];let s=e.head,h=null;for(;s;){if(s.value.key===t)return h?h.next=s.next:e.head=s.next,s===e.tail&&(e.tail=h),this.size--,s.value.value;h=s,s=s.next}return null}length(){return this.size()}clear(){this.buckets=new Array(this.buckets.length).fill(null).map((()=>new e)),this.size=0}};console.log(n.hash("Yorkshire")),console.log(n.hash("Yorkshire")),console.log(n.hash("Center")),console.log(n.hash("center")),console.log(n.hash("CENTER")),n.set("Joe24235","@mogus"),console.log(n.get("Joe24235")),console.log(n.has("Joe24235"))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixLQUFLQyxHQUV6QixHQUFJQyxFQUFXLEdBQUtBLEdBQVlQLFFBQVFRLE9BQ3BDLE1BQU0sSUFBSUksTUFBTSx1Q0FFaEJELEVBQVNyQyxLQUFLMEIsUUFBUU8sR0FHMUIsSUFBSXZCLEVBQWMyQixFQUFPbEMsS0FDckJ3QyxFQUFlLEtBRW5CLEtBQU1qQyxHQUFhLENBQ2YsR0FBR0EsRUFBWVgsTUFBTWlDLE1BQVFBLEVBYXpCLE9BWkdXLEVBRUNBLEVBQWExQyxLQUFPUyxFQUFZVCxLQUVoQ29DLEVBQU9sQyxLQUFPTyxFQUFZVCxLQUczQlMsSUFBZ0IyQixFQUFPakMsT0FDdEJpQyxFQUFPakMsS0FBT3VDLEdBR2xCM0MsS0FBS1EsT0FDRUUsRUFBWVgsTUFBTUEsTUFFN0I0QyxFQUFlakMsRUFDZkEsRUFBY0EsRUFBWVQsSUFDOUIsQ0FDQSxPQUFPLElBQ1gsQ0FHQSxNQUFBaUMsR0FDSSxPQUFPbEMsS0FBS1EsTUFDaEIsQ0FFQSxLQUFBb0MsR0FDSTVDLEtBQUswQixRQUFVLElBQUlDLE1BQU0zQixLQUFLMEIsUUFBUVEsUUFBUU4sS0FBSyxNQUFNQyxLQUFJLElBQU0sSUFBSTNCLElBQ3ZFRixLQUFLUSxLQUFPLENBQ2hCLEdEN0hKTSxRQUFRQyxJQUFJUyxFQUFRTyxLQUFLLGNBQ3pCakIsUUFBUUMsSUFBSVMsRUFBUU8sS0FBSyxjQUN6QmpCLFFBQVFDLElBQUlTLEVBQVFPLEtBQUssV0FDekJqQixRQUFRQyxJQUFJUyxFQUFRTyxLQUFLLFdBQ3pCakIsUUFBUUMsSUFBSVMsRUFBUU8sS0FBSyxXQUV6QlAsRUFBUVksSUFBSSxXQUFZLFVBQ3hCdEIsUUFBUUMsSUFBSVMsRUFBUWdCLElBQUksYUFDeEIxQixRQUFRQyxJQUFJUyxFQUFRaUIsSUFBSSxZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBpZGVtby8uL3NyYy9saW5rZWRMaXN0LmpzIiwid2VicGFjazovL2FwaWRlbW8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYXBpZGVtby8uL3NyYy9oYXNoTWFwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBOb2RlIHtcbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSl7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBMaW5rZWRMaXN0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5oZWFkID0gbnVsbDtcbiAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcbiAgICB9XG5cbiAgICBhcHBlbmQodmFsdWUpIHtcbiAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcbiAgICAgICAgaWYoIXRoaXMuaGVhZCl7XG4gICAgICAgICAgICAvLyBJZiB0aGUgbGlzdCBpcyBudWxsL2VtcHR5LCB0aGUgbmV3IG5vZGUgaXMgYm90aCB0aGUgaGVhZCBhbmQgdGFpbFxuICAgICAgICAgICAgdGhpcy5oZWFkID0gbmV3Tm9kZTtcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IG5ld05vZGU7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGFpbC5uZXh0ID0gbmV3Tm9kZTtcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IG5ld05vZGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVwZW5kKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgIGlmKCF0aGlzLmhlYWQpIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IG5ld05vZGU7XG4gICAgICAgICAgICB0aGlzLnRhaWwgPSBuZXdOb2RlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3Tm9kZS5uZXh0ID0gdGhpcy5oZWFkO1xuICAgICAgICAgICAgdGhpcy5oZWFkID0gbmV3Tm9kZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNpemUoKXtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgIHdoaWxlKCF0aGlzLmhlYWQpe1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpO1xuICAgIH1cblxuICAgIC8vIGhlYWQoKXtcbiAgICAvLyAgICAgaWYodGhpcy5oZWFkKXtcbiAgICAvLyAgICAgICAgIGNvbnN0IGhlYWROb2RlID0gdGhpcy5oZWFkO1xuICAgIC8vICAgICAgICAgcmV0dXJuIGhlYWROb2RlO1xuICAgIC8vICAgICB9IGVsc2Uge1xuICAgIC8vICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG5cbiAgICAvLyB0YWlsKCl7XG4gICAgLy8gICAgIGlmKHRoaXMudGFpbCl7XG4gICAgLy8gICAgICAgICBjb25zdCB0YWlsTm9kZSA9IHRoaXMudGFpbDtcbiAgICAvLyAgICAgICAgIHJldHVybiB0YWlsTm9kZTtcbiAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgIHJldHVybiBudWxsO1xuICAgIC8vICAgICB9XG4gICAgLy8gfVxuXG4gICAgYXQoaW5kZXgpe1xuICAgICAgICBpZiAoaW5kZXggPCAwKSByZXR1cm4gbnVsbDsgLy8gSW5kZXggc2hvdWxkIGJlIG5vbi1uZWdhdGl2ZVxuICAgICAgICBpZih0aGlzLmhlYWQpIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgICAgIHdoaWxlKGkgPCBpbmRleCl7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50Tm9kZSA/IGN1cnJlbnROb2RlIDogbnVsbDsgLy8gUmV0dXJuIHRoZSBub2RlIGlmIGZvdW5kLCBlbHNlIG51bGxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHBvcCgpe1xuICAgICAgICBpZiAoIXRoaXMudGFpbCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJObyBpdGVtIHRvIHBvcFwiKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcG9wcGVkVmFsdWUgPSB0aGlzLnRhaWwudmFsdWU7XG5cbiAgICAgICAgaWYgKHRoaXMuaGVhZCA9PT0gdGhpcy50YWlsKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGVyZSdzIG9ubHkgb25lIG5vZGUgaW4gdGhlIGxpc3RcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnRhaWwgPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIHBvcHBlZFZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICB3aGlsZShjdXJyZW50Tm9kZS5uZXh0ICE9PSB0aGlzLnRhaWwpe1xuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIC8vIE5vdyBjdXJyZW50Tm9kZSBpcyB0aGUgc2Vjb25kLXRvLWxhc3Qgbm9kZVxuICAgICAgICBjdXJyZW50Tm9kZS5uZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy50YWlsID0gY3VycmVudE5vZGU7XG5cbiAgICAgICAgcmV0dXJuIHBvcHBlZFZhbHVlO1xuICAgIH1cblxuICAgIGNvbnRhaW5zKHZhbHVlKSB7XG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgd2hpbGUoY3VycmVudE5vZGUubmV4dCAhPT0gbnVsbCl7XG4gICAgICAgICAgICBpZihjdXJyZW50Tm9kZS52YWx1ZSA9PT0gdmFsdWUpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGZpbmQodmFsdWUpIHtcbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHdoaWxlKGN1cnJlbnROb2RlKXtcbiAgICAgICAgICAgIGlmKGN1cnJlbnROb2RlLnZhbHVlID09PSB2YWx1ZSl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIHRvU3RyaW5nKCl7XG4gICAgICAgIGxldCBvdXRwdXQgPSBcIlwiXG4gICAgICAgIGlmKCF0aGlzLmhlYWQpe1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgICAgICB3aGlsZShjdXJyZW50Tm9kZSl7XG4gICAgICAgICAgICAgICAgaWYoY3VycmVudE5vZGUubmV4dCA9PT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQgKz0gXCJudWxsXCIgO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBgKCAke2N1cnJlbnROb2RlLnZhbHVlfSApIC0+IGA7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbnNlcnRBdCh2YWx1ZSwgaW5kZXgpe1xuICAgICAgICBpZiAoaW5kZXggPCAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUodmFsdWUpO1xuXG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgLy8gSW5zZXJ0IGF0IHRoZSBoZWFkXG4gICAgICAgICAgICBuZXdOb2RlLm5leHQgPSB0aGlzLmhlYWQ7XG4gICAgICAgICAgICB0aGlzLmhlYWQgPSBuZXdOb2RlO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRhaWwpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIGxpc3Qgd2FzIGVtcHR5LCB1cGRhdGUgdGhlIHRhaWwgYXMgd2VsbFxuICAgICAgICAgICAgICB0aGlzLnRhaWwgPSBuZXdOb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgIGxldCBpID0gMDtcblxuICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUgJiYgaSA8IGluZGV4IC0gMSkge1xuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjdXJyZW50Tm9kZSkgcmV0dXJuIGZhbHNlOyAvLyBJbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gICAgICAgIFxuICAgICAgICBuZXdOb2RlLm5leHQgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICBjdXJyZW50Tm9kZS5uZXh0ID0gbmV3Tm9kZTtcbiAgICBcbiAgICAgICAgaWYgKCFuZXdOb2RlLm5leHQpIHtcbiAgICAgICAgICAvLyBJZiB0aGUgbmV3IG5vZGUgaXMgaW5zZXJ0ZWQgYXQgdGhlIGVuZCwgdXBkYXRlIHRoZSB0YWlsXG4gICAgICAgICAgdGhpcy50YWlsID0gbmV3Tm9kZTtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIFxuICAgIC8vIE1ldGhvZCB0byByZW1vdmUgYSBub2RlIGF0IGEgc3BlY2lmaWMgaW5kZXhcbiAgICByZW1vdmVBdChpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPCAwIHx8ICF0aGlzLmhlYWQpIHJldHVybiBudWxsOyAvLyBJbmRleCBpcyBpbnZhbGlkIG9yIGxpc3QgaXMgZW1wdHlcblxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaGVhZCBub2RlXG4gICAgICAgICAgICBjb25zdCByZW1vdmVkVmFsdWUgPSB0aGlzLmhlYWQudmFsdWU7XG4gICAgICAgICAgICB0aGlzLmhlYWQgPSB0aGlzLmhlYWQubmV4dDtcbiAgICAgICAgICAgIGlmICghdGhpcy5oZWFkKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGxpc3QgYmVjb21lcyBlbXB0eSwgdXBkYXRlIHRoZSB0YWlsXG4gICAgICAgICAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZW1vdmVkVmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgIGxldCBpID0gMDtcblxuICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUubmV4dCAmJiBpIDwgaW5kZXggLSAxKSB7XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWN1cnJlbnROb2RlLm5leHQpIHJldHVybiBudWxsOyAvLyBJbmRleCBpcyBvdXQgb2YgYm91bmRzXG5cbiAgICAgICAgY29uc3QgcmVtb3ZlZFZhbHVlID0gY3VycmVudE5vZGUubmV4dC52YWx1ZTtcbiAgICAgICAgY3VycmVudE5vZGUubmV4dCA9IGN1cnJlbnROb2RlLm5leHQubmV4dDtcblxuICAgICAgICBpZiAoIWN1cnJlbnROb2RlLm5leHQpIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSByZW1vdmVkIG5vZGUgd2FzIHRoZSB0YWlsLCB1cGRhdGUgdGhlIHRhaWxcbiAgICAgICAgICAgIHRoaXMudGFpbCA9IGN1cnJlbnROb2RlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlbW92ZWRWYWx1ZTtcbiAgICB9XG59XG5cbi8vIEV4YW1wbGUgdXNhZ2U6XG4vLyBjb25zdCBsaXN0ID0gbmV3IExpbmtlZExpc3QoKTtcbi8vIGxpc3QuYXBwZW5kKDEpO1xuLy8gbGlzdC5hcHBlbmQoMik7XG4vLyBsaXN0LmFwcGVuZCgzKTtcbi8vIGxpc3QucHJlcGVuZCgwKTtcblxuLy8gbGlzdC5pbnNlcnRBdCgxLjUsIDIpO1xuLy8gY29uc29sZS5sb2coJ0xpbmtlZExpc3Q6JywgbGlzdC50b1N0cmluZygpKTsgLy8gT3V0cHV0OiAoIDAgKSAtPiAoIDEgKSAtPiAoIDEuNSApIC0+ICggMiApIC0+ICggMyApIC0+IG51bGxcblxuLy8gbGlzdC5yZW1vdmVBdCgyKTtcbi8vIGNvbnNvbGUubG9nKCdMaW5rZWRMaXN0IGFmdGVyIHJlbW92YWw6JywgbGlzdC50b1N0cmluZygpKTsgLy8gT3V0cHV0OiAoIDAgKSAtPiAoIDEgKSAtPiAoIDIgKSAtPiAoIDMgKSAtPiBudWxsXG5cbi8vIGxpc3QucmVtb3ZlQXQoMCk7XG4vLyBjb25zb2xlLmxvZygnTGlua2VkTGlzdCBhZnRlciByZW1vdmluZyBoZWFkOicsIGxpc3QudG9TdHJpbmcoKSk7IC8vIE91dHB1dDogKCAxICkgLT4gKCAyICkgLT4gKCAzICkgLT4gbnVsbFxuXG4vLyBsaXN0LnJlbW92ZUF0KDIpO1xuLy8gY29uc29sZS5sb2coJ0xpbmtlZExpc3QgYWZ0ZXIgcmVtb3ZpbmcgdGFpbDonLCBsaXN0LnRvU3RyaW5nKCkpOyAvLyBPdXRwdXQ6ICggMSApIC0+ICggMiApIC0+IG51bGwiLCJpbXBvcnQgeyBMaW5rZWRMaXN0LCBOb2RlIH0gZnJvbSBcIi4vbGlua2VkTGlzdFwiO1xuaW1wb3J0IHsgSGFzaE1hcCB9IGZyb20gXCIuL2hhc2hNYXBcIlxuXG5jb25zdCBoYXNobWFwID0gbmV3IEhhc2hNYXAoKTtcblxuY29uc29sZS5sb2coaGFzaG1hcC5oYXNoKFwiWW9ya3NoaXJlXCIpKTtcbmNvbnNvbGUubG9nKGhhc2htYXAuaGFzaChcIllvcmtzaGlyZVwiKSk7XG5jb25zb2xlLmxvZyhoYXNobWFwLmhhc2goXCJDZW50ZXJcIikpO1xuY29uc29sZS5sb2coaGFzaG1hcC5oYXNoKFwiY2VudGVyXCIpKTtcbmNvbnNvbGUubG9nKGhhc2htYXAuaGFzaChcIkNFTlRFUlwiKSk7XG5cbmhhc2htYXAuc2V0KFwiSm9lMjQyMzVcIiwgXCJAbW9ndXNcIik7XG5jb25zb2xlLmxvZyhoYXNobWFwLmdldChcIkpvZTI0MjM1XCIpKTtcbmNvbnNvbGUubG9nKGhhc2htYXAuaGFzKFwiSm9lMjQyMzVcIikpO1xuXG5cbi8vaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBidWNrZXRzLmxlbmd0aCkge1xuLy8gICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuLy8gfVxuXG4vLyBjbGFzcyBOb2RlIHtcbi8vICAgICBjb25zdHJ1Y3RvcihrZXksIHZhbHVlLCBuZXh0ID0gbnVsbCkge1xuLy8gICAgICAgICB0aGlzLmtleSA9IGtleTtcbi8vICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuLy8gICAgICAgICB0aGlzLm5leHQgPSBuZXh0O1xuLy8gICAgIH1cbi8vIH1cblxuLy9JIGNvdWxkIHByb2JhYmx5IGp1c3QgcmV1c2UgdGhlIGxpbmtlZCBsaXN0IEkgbWFkZSBpbiBodHRwczovL2dpdGh1Yi5jb20vRHJFcGljby9MaW5rZWRMaXN0L2Jsb2IvbWFpbi9zcmMvaW5kZXguanMgb24gYSBzZXBhcmF0ZSBzY3JpcHQgZmlsZSBcbi8vIGNsYXNzIExpbmtlZExpc3Qge1xuLy8gICAgIGNvbnN0cnVjdG9yKCkge1xuLy8gICAgICAgICB0aGlzLmhlYWQgPSBudWxsO1xuLy8gICAgIH1cbiAgXG4gICAgLy8gSW5zZXJ0IGEgbmV3IG5vZGUgb3IgdXBkYXRlIGFuIGV4aXN0aW5nIG5vZGVcbiAgICAvLyBpbnNlcnQoa2V5LCB2YWx1ZSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgbm9kZS52YWx1ZSA9IHZhbHVlOyAvLyBVcGRhdGUgZXhpc3Rpbmcga2V5XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgbm9kZSA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUoa2V5LCB2YWx1ZSwgdGhpcy5oZWFkKTtcbiAgICAvLyAgICAgdGhpcy5oZWFkID0gbmV3Tm9kZTsgLy8gSW5zZXJ0IG5ldyBub2RlIGF0IHRoZSBoZWFkXG4gICAgLy8gfVxuICBcbiAgICAvLyAvLyBGaW5kIGEgbm9kZSBieSBrZXlcbiAgICAvLyBmaW5kKGtleSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuIG5vZGUudmFsdWU7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgICBub2RlID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIHJldHVybiBudWxsO1xuICAgIC8vIH1cbiAgXG4gICAgLy8gLy8gQ2hlY2sgaWYgYSBrZXkgZXhpc3RzXG4gICAgLy8gaGFzKGtleSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgICBub2RlID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIHJldHVybiBmYWxzZTtcbiAgICAvLyB9XG4gIFxuICAgIC8vIC8vIFJlbW92ZSBhIG5vZGUgYnkga2V5XG4gICAgLy8gcmVtb3ZlKGtleSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgbGV0IHByZXYgPSBudWxsO1xuICAgIC8vICAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkge1xuICAgIC8vICAgICAgICAgaWYgKG5vZGUua2V5ID09PSBrZXkpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAocHJldiA9PT0gbnVsbCkge1xuICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLmhlYWQgPSBub2RlLm5leHQ7XG4gICAgLy8gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgcHJldi5uZXh0ID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIHByZXYgPSBub2RlO1xuICAgIC8vICAgICAgICAgbm9kZSA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICByZXR1cm4gZmFsc2U7XG4gICAgLy8gfVxuLy8gfVxuXG4iLCJpbXBvcnQgeyBMaW5rZWRMaXN0LCBOb2RlIH0gZnJvbSBcIi4vbGlua2VkTGlzdFwiO1xuXG4vL2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9SDYySmZ2MURKbFVcbmV4cG9ydCBjbGFzcyBIYXNoTWFwIHtcbiAgICBjb25zdHJ1Y3RvcihjYXBhY2l0eSA9IDgpIHtcbiAgICAgICAgdGhpcy5idWNrZXRzID0gbmV3IEFycmF5KGNhcGFjaXR5KS5maWxsKG51bGwpLm1hcCgoKSA9PiBuZXcgTGlua2VkTGlzdCgpKTsgXG4gICAgICAgIC8vbWFwKCgpID0+IG5ldyBMaW5rZWRMaXN0KCkgVHJhbnNmb3JtcyBlYWNoIG51bGwgdmFsdWUgaW50byBhbiBlbXB0eSBsaW5rZWQgbGlzdC5cbiAgICAgICAgdGhpcy5zaXplID0gMDtcbiAgICAgICAgdGhpcy5sb2FkRmFjdG9yID0gMC43NTtcbiAgICB9XG4gIFxuICAgIC8vIEhhc2ggZnVuY3Rpb25cbiAgICBoYXNoKGtleSkge1xuICAgICAgICBsZXQgaGFzaENvZGUgPSAwO1xuICAgICAgICBjb25zdCBwcmltZU51bWJlciA9IDMxO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaGFzaENvZGUgPSAocHJpbWVOdW1iZXIgKiBoYXNoQ29kZSArIGtleS5jaGFyQ29kZUF0KGkpKSAlIHRoaXMuYnVja2V0cy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhc2hDb2RlO1xuICAgIH1cblxuICAgIHNldChrZXksIHZhbHVlKXtcbiAgICAgICAgbGV0IGhhc2hDb2RlID0gdGhpcy5oYXNoKGtleSk7XG4gICAgICAgIGxldCBidWNrZXQ7XG4gICAgICAgIGlmIChoYXNoQ29kZSA8IDAgfHwgaGFzaENvZGUgPj0gYnVja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVja2V0ID0gdGhpcy5idWNrZXRzW2hhc2hDb2RlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBrZXkgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGJ1Y2tldFxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudE5vZGUudmFsdWUua2V5ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZS52YWx1ZS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYnVja2V0LmFwcGVuZCh7IGtleSwgdmFsdWUgfSk7XG4gICAgICAgIHRoaXMuc2l6ZSsrO1xuXG4gICAgICAgIC8vIFJlc2l6ZSBpZiBsb2FkIGZhY3RvciBpcyBleGNlZWRlZFxuICAgICAgICBpZiAodGhpcy5zaXplIC8gdGhpcy5idWNrZXRzLmxlbmd0aCA+IHRoaXMubG9hZEZhY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5yZXNpemUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldChrZXkpe1xuICAgICAgICBsZXQgaGFzaENvZGUgPSB0aGlzLmhhc2goa2V5KTtcbiAgICAgICAgbGV0IGJ1Y2tldDtcbiAgICAgICAgaWYgKGhhc2hDb2RlIDwgMCB8fCBoYXNoQ29kZSA+PSBidWNrZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBpbmRleCBvdXQgb2YgYm91bmRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWNrZXQgPSB0aGlzLmJ1Y2tldHNbaGFzaENvZGVdO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gYnVja2V0LmhlYWQ7XG4gICAgICAgIHdoaWxlIChjdXJyZW50Tm9kZSkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlLnZhbHVlLmtleSA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLnZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFwiTm90IGZvdW5kXCI7XG4gICAgfVxuXG4gICAgaGFzKGtleSl7XG4gICAgICAgIGxldCBoYXNoQ29kZSA9IHRoaXMuaGFzaChrZXkpO1xuICAgICAgICBsZXQgYnVja2V0O1xuICAgICAgICBpZiAoaGFzaENvZGUgPCAwIHx8IGhhc2hDb2RlID49IGJ1Y2tldHMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcnlpbmcgdG8gYWNjZXNzIGluZGV4IG91dCBvZiBib3VuZFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1Y2tldCA9IHRoaXMuYnVja2V0c1toYXNoQ29kZV07XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudE5vZGUudmFsdWUua2V5ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmVtb3ZlKGtleSkge1xuICAgICAgICBsZXQgaGFzaENvZGUgPSB0aGlzLmhhc2goa2V5KTtcbiAgICAgICAgbGV0IGJ1Y2tldDtcbiAgICAgICAgaWYgKGhhc2hDb2RlIDwgMCB8fCBoYXNoQ29kZSA+PSBidWNrZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBpbmRleCBvdXQgb2YgYm91bmRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWNrZXQgPSB0aGlzLmJ1Y2tldHNbaGFzaENvZGVdO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gYnVja2V0LmhlYWQ7XG4gICAgICAgIGxldCBwcmV2aW91c05vZGUgPSBudWxsO1xuXG4gICAgICAgIHdoaWxlKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZihjdXJyZW50Tm9kZS52YWx1ZS5rZXkgPT09IGtleSl7XG4gICAgICAgICAgICAgICAgaWYocHJldmlvdXNOb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgLy9kZWxldGVzIGN1cnJlbnQgbm9kZSBieSBieXBhc3NpbmcgaXRcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNOb2RlLm5leHQgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1Y2tldC5oZWFkID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgbm9kZSBpcyB0aGUgdGFpbCwgdXBkYXRlIHRoZSB0YWlsIHJlZmVyZW5jZVxuICAgICAgICAgICAgICAgIGlmKGN1cnJlbnROb2RlID09PSBidWNrZXQudGFpbCl7XG4gICAgICAgICAgICAgICAgICAgIGJ1Y2tldC50YWlsID0gcHJldmlvdXNOb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLnNpemUtLTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudE5vZGUudmFsdWUudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmV2aW91c05vZGUgPSBjdXJyZW50Tm9kZTtcbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvL1JldHVybnMgdGhlIG51bWJlciBvZiBzdG9yZWQga2V5cyBpbiB0aGUgaGFzaCBtYXBcbiAgICBsZW5ndGgoKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZSgpO1xuICAgIH1cblxuICAgIGNsZWFyKCl7XG4gICAgICAgIHRoaXMuYnVja2V0cyA9IG5ldyBBcnJheSh0aGlzLmJ1Y2tldHMubGVuZ3RoKS5maWxsKG51bGwpLm1hcCgoKSA9PiBuZXcgTGlua2VkTGlzdCgpKTtcbiAgICAgICAgdGhpcy5zaXplID0gMDtcbiAgICB9XG59Il0sIm5hbWVzIjpbIk5vZGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwidGhpcyIsIm5leHQiLCJMaW5rZWRMaXN0IiwiaGVhZCIsInRhaWwiLCJhcHBlbmQiLCJuZXdOb2RlIiwicHJlcGVuZCIsInNpemUiLCJpIiwiY3VycmVudE5vZGUiLCJhdCIsImluZGV4IiwicG9wIiwiY29uc29sZSIsImxvZyIsInBvcHBlZFZhbHVlIiwiY29udGFpbnMiLCJmaW5kIiwidG9TdHJpbmciLCJvdXRwdXQiLCJpbnNlcnRBdCIsInJlbW92ZUF0IiwicmVtb3ZlZFZhbHVlIiwiaGFzaG1hcCIsImNhcGFjaXR5IiwiYnVja2V0cyIsIkFycmF5IiwiZmlsbCIsIm1hcCIsImxvYWRGYWN0b3IiLCJoYXNoIiwia2V5IiwiaGFzaENvZGUiLCJsZW5ndGgiLCJjaGFyQ29kZUF0Iiwic2V0IiwiYnVja2V0IiwiRXJyb3IiLCJyZXNpemUiLCJnZXQiLCJoYXMiLCJyZW1vdmUiLCJwcmV2aW91c05vZGUiLCJjbGVhciJdLCJzb3VyY2VSb290IjoiIn0=