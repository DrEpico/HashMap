(()=>{"use strict";class e{constructor(e){this.value=e,this.next=null}}class t{constructor(){this.head=null,this.tail=null}append(t){const s=new e(t);this.head?(this.tail.next=s,this.tail=s):(this.head=s,this.tail=s)}prepend(t){const s=new e(t);this.head?(s.next=this.head,this.head=s):(this.head=s,this.tail=s)}size(){let e=0,t=this.head;for(;!this.head;)e++,t=t.next;return e}at(e){if(e<0)return null;if(this.head){let t=this.head,s=0;for(;s<e;)s++,t=t.next;return t||null}}pop(){if(!this.tail)return console.log("No item to pop"),null;const e=this.tail.value;if(this.head===this.tail)return this.head=null,this.tail=null,e;let t=this.head;for(;t.next!==this.tail;)t=t.next;return t.next=null,this.tail=t,e}contains(e){let t=this.head;for(;null!==t.next;){if(t.value===e)return!0;t=t.next}return!1}find(e){let t=this.head,s=0;for(;t;){if(t.value===e)return s;t=t.next,s++}return-1}toString(){let e="";if(this.head){let t=this.head;for(;t;){if(null===t.next)return e+"null";e+=`( ${t.value} ) -> `,t=t.next}return e}return null}insertAt(t,s){if(s<0)return null;const n=new e(t);if(0===s)return n.next=this.head,this.head=n,this.tail||(this.tail=n),!0;let l=this.head,h=0;for(;l&&h<s-1;)l=l.next,h++;return!!l&&(n.next=l.next,l.next=n,n.next||(this.tail=n),!0)}removeAt(e){if(e<0||!this.head)return null;if(0===e){const e=this.head.value;return this.head=this.head.next,this.head||(this.tail=null),e}let t=this.head,s=0;for(;t.next&&s<e-1;)t=t.next,s++;if(!t.next)return null;const n=t.next.value;return t.next=t.next.next,t.next||(this.tail=t),n}}class s{constructor(e=8){this.buckets=new Array(e).fill(null).map((()=>new t)),this.size=0,this.loadFactor=.75}hash(e){let t=0;for(let s=0;s<e.length;s++)t=(31*t+e.charCodeAt(s))%this.buckets.length;return t}set(e,t){let s,n=this.hash(e);if(n<0||n>=this.buckets.length)throw new Error("Trying to access index out of bound");s=this.buckets[n];let l=s.head;for(;l;){if(l.value.key===e)return void(l.value.value=t);l=l.next}s.append({key:e,value:t}),this.size++,this.size/this.buckets.length>this.loadFactor&&(this.resize(),console.log("resized hashmap"))}get(e){let t,s=this.hash(e);if(s<0||s>=this.buckets.length)throw new Error("Trying to access index out of bound");t=this.buckets[s];let n=t.head;for(;n;){if(n.value.key===e)return n.value.value;n=n.next}return"Not found"}has(e){let t,s=this.hash(e);if(s<0||s>=this.buckets.length)throw new Error("Trying to access index out of bound");t=this.buckets[s];let n=t.head;for(;n;){if(n.value.key===e)return!0;n=n.next}return!1}remove(e){let t,s=this.hash(e);if(s<0||s>=this.buckets.length)throw new Error("Trying to access index out of bound");t=this.buckets[s];let n=t.head,l=null;for(;n;){if(n.value.key===e)return l?l.next=n.next:t.head=n.next,n===t.tail&&(t.tail=l),this.size--,n.value.value;l=n,n=n.next}return null}length(){return this.size()}clear(){this.buckets=new Array(this.buckets.length).fill(null).map((()=>new t)),this.size=0}keys(){const e=[];for(let t of this.buckets){let s=t.head;for(;s;)e.push(s.value.key),s=s.next}return e}values(){const e=[];for(let t of this.buckets){let s=t.head;for(;s;)e.push(s.value.value),s=s.next}return e}entries(){const e=[];for(let t of this.buckets){let s=t.head;for(;s;){const t=[s.value.key,s.value.value];e.push(t),s=s.next}}return e}resize(){const e=2*this.buckets.length,s=new Array(e).fill(null).map((()=>new t));for(let e of this.buckets){let t=e.head;for(;t;)s[this.hash(t.value.key)].append(t.value),t=t.next}this.buckets=s}}const n=new s;console.log(n.hash("Yorkshire")),console.log(n.hash("Yorkshire")),console.log(n.hash("Center")),console.log(n.hash("center")),console.log(n.hash("CENTER")),n.set("Joe24235","@mogus"),console.log(n.get("Joe24235")),console.log(n.has("Joe24235")),function(){const e=new s;e.set("apple","red"),e.set("banana","yellow"),e.set("carrot","orange"),e.set("dog","brown"),e.set("elephant","gray"),e.set("frog","green"),e.set("frog","blue"),console.log(e.entries())}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixJQUFJLFNBQVUsVUFDbkJvQixFQUFLcEIsSUFBSSxTQUFVLFVBQ25Cb0IsRUFBS3BCLElBQUksTUFBTyxTQUNoQm9CLEVBQUtwQixJQUFJLFdBQVksUUFDckJvQixFQUFLcEIsSUFBSSxPQUFRLFNBQ2pCb0IsRUFBS3BCLElBQUksT0FBUSxRQVFqQnRCLFFBQVFDLElBQUl5QyxFQUFLTixVQUNyQixDREpBTSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBpZGVtby8uL3NyYy9saW5rZWRMaXN0LmpzIiwid2VicGFjazovL2FwaWRlbW8vLi9zcmMvaGFzaE1hcC5qcyIsIndlYnBhY2s6Ly9hcGlkZW1vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL2FwaWRlbW8vLi9zcmMvdGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgTm9kZSB7XG4gICAgY29uc3RydWN0b3IodmFsdWUpe1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMubmV4dCA9IG51bGw7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGlua2VkTGlzdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaGVhZCA9IG51bGw7XG4gICAgICAgIHRoaXMudGFpbCA9IG51bGw7XG4gICAgfVxuXG4gICAgYXBwZW5kKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgIGlmKCF0aGlzLmhlYWQpe1xuICAgICAgICAgICAgLy8gSWYgdGhlIGxpc3QgaXMgbnVsbC9lbXB0eSwgdGhlIG5ldyBub2RlIGlzIGJvdGggdGhlIGhlYWQgYW5kIHRhaWxcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IG5ld05vZGU7XG4gICAgICAgICAgICB0aGlzLnRhaWwgPSBuZXdOb2RlO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRhaWwubmV4dCA9IG5ld05vZGU7XG4gICAgICAgICAgICB0aGlzLnRhaWwgPSBuZXdOb2RlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJlcGVuZCh2YWx1ZSkge1xuICAgICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUodmFsdWUpO1xuICAgICAgICBpZighdGhpcy5oZWFkKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWQgPSBuZXdOb2RlO1xuICAgICAgICAgICAgdGhpcy50YWlsID0gbmV3Tm9kZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld05vZGUubmV4dCA9IHRoaXMuaGVhZDtcbiAgICAgICAgICAgIHRoaXMuaGVhZCA9IG5ld05vZGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzaXplKCl7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICB3aGlsZSghdGhpcy5oZWFkKXtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaTtcbiAgICB9XG5cbiAgICAvLyBoZWFkKCl7XG4gICAgLy8gICAgIGlmKHRoaXMuaGVhZCl7XG4gICAgLy8gICAgICAgICBjb25zdCBoZWFkTm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgICAgIHJldHVybiBoZWFkTm9kZTtcbiAgICAvLyAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgIHJldHVybiBudWxsO1xuICAgIC8vICAgICB9XG4gICAgLy8gfVxuXG4gICAgLy8gdGFpbCgpe1xuICAgIC8vICAgICBpZih0aGlzLnRhaWwpe1xuICAgIC8vICAgICAgICAgY29uc3QgdGFpbE5vZGUgPSB0aGlzLnRhaWw7XG4gICAgLy8gICAgICAgICByZXR1cm4gdGFpbE5vZGU7XG4gICAgLy8gICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAvLyAgICAgfVxuICAgIC8vIH1cblxuICAgIGF0KGluZGV4KXtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkgcmV0dXJuIG51bGw7IC8vIEluZGV4IHNob3VsZCBiZSBub24tbmVnYXRpdmVcbiAgICAgICAgaWYodGhpcy5oZWFkKSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgICB3aGlsZShpIDwgaW5kZXgpe1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudE5vZGUgPyBjdXJyZW50Tm9kZSA6IG51bGw7IC8vIFJldHVybiB0aGUgbm9kZSBpZiBmb3VuZCwgZWxzZSBudWxsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwb3AoKXtcbiAgICAgICAgaWYgKCF0aGlzLnRhaWwpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gaXRlbSB0byBwb3BcIik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBvcHBlZFZhbHVlID0gdGhpcy50YWlsLnZhbHVlO1xuXG4gICAgICAgIGlmICh0aGlzLmhlYWQgPT09IHRoaXMudGFpbCkge1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUncyBvbmx5IG9uZSBub2RlIGluIHRoZSBsaXN0XG4gICAgICAgICAgICB0aGlzLmhlYWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy50YWlsID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiBwb3BwZWRWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgd2hpbGUoY3VycmVudE5vZGUubmV4dCAhPT0gdGhpcy50YWlsKXtcbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICAvLyBOb3cgY3VycmVudE5vZGUgaXMgdGhlIHNlY29uZC10by1sYXN0IG5vZGVcbiAgICAgICAgY3VycmVudE5vZGUubmV4dCA9IG51bGw7XG4gICAgICAgIHRoaXMudGFpbCA9IGN1cnJlbnROb2RlO1xuXG4gICAgICAgIHJldHVybiBwb3BwZWRWYWx1ZTtcbiAgICB9XG5cbiAgICBjb250YWlucyh2YWx1ZSkge1xuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzLmhlYWQ7XG4gICAgICAgIHdoaWxlKGN1cnJlbnROb2RlLm5leHQgIT09IG51bGwpe1xuICAgICAgICAgICAgaWYoY3VycmVudE5vZGUudmFsdWUgPT09IHZhbHVlKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmaW5kKHZhbHVlKSB7XG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXMuaGVhZDtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICB3aGlsZShjdXJyZW50Tm9kZSl7XG4gICAgICAgICAgICBpZihjdXJyZW50Tm9kZS52YWx1ZSA9PT0gdmFsdWUpe1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICB0b1N0cmluZygpe1xuICAgICAgICBsZXQgb3V0cHV0ID0gXCJcIlxuICAgICAgICBpZighdGhpcy5oZWFkKXtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICAgICAgd2hpbGUoY3VycmVudE5vZGUpe1xuICAgICAgICAgICAgICAgIGlmKGN1cnJlbnROb2RlLm5leHQgPT09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0ICs9IFwibnVsbFwiIDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gYCggJHtjdXJyZW50Tm9kZS52YWx1ZX0gKSAtPiBgO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5zZXJ0QXQodmFsdWUsIGluZGV4KXtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcblxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIC8vIEluc2VydCBhdCB0aGUgaGVhZFxuICAgICAgICAgICAgbmV3Tm9kZS5uZXh0ID0gdGhpcy5oZWFkO1xuICAgICAgICAgICAgdGhpcy5oZWFkID0gbmV3Tm9kZTtcbiAgICAgICAgICAgIGlmICghdGhpcy50YWlsKSB7XG4gICAgICAgICAgICAgIC8vIElmIHRoZSBsaXN0IHdhcyBlbXB0eSwgdXBkYXRlIHRoZSB0YWlsIGFzIHdlbGxcbiAgICAgICAgICAgICAgdGhpcy50YWlsID0gbmV3Tm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICBsZXQgaSA9IDA7XG5cbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlICYmIGkgPCBpbmRleCAtIDEpIHtcbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY3VycmVudE5vZGUpIHJldHVybiBmYWxzZTsgLy8gSW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICAgICAgICBcbiAgICAgICAgbmV3Tm9kZS5uZXh0ID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgY3VycmVudE5vZGUubmV4dCA9IG5ld05vZGU7XG4gICAgXG4gICAgICAgIGlmICghbmV3Tm9kZS5uZXh0KSB7XG4gICAgICAgICAgLy8gSWYgdGhlIG5ldyBub2RlIGlzIGluc2VydGVkIGF0IHRoZSBlbmQsIHVwZGF0ZSB0aGUgdGFpbFxuICAgICAgICAgIHRoaXMudGFpbCA9IG5ld05vZGU7XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBcbiAgICAvLyBNZXRob2QgdG8gcmVtb3ZlIGEgbm9kZSBhdCBhIHNwZWNpZmljIGluZGV4XG4gICAgcmVtb3ZlQXQoaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCAhdGhpcy5oZWFkKSByZXR1cm4gbnVsbDsgLy8gSW5kZXggaXMgaW52YWxpZCBvciBsaXN0IGlzIGVtcHR5XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGhlYWQgbm9kZVxuICAgICAgICAgICAgY29uc3QgcmVtb3ZlZFZhbHVlID0gdGhpcy5oZWFkLnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5oZWFkID0gdGhpcy5oZWFkLm5leHQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaGVhZCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBsaXN0IGJlY29tZXMgZW1wdHksIHVwZGF0ZSB0aGUgdGFpbFxuICAgICAgICAgICAgICAgIHRoaXMudGFpbCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlZFZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcy5oZWFkO1xuICAgICAgICBsZXQgaSA9IDA7XG5cbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlLm5leHQgJiYgaSA8IGluZGV4IC0gMSkge1xuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjdXJyZW50Tm9kZS5uZXh0KSByZXR1cm4gbnVsbDsgLy8gSW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuXG4gICAgICAgIGNvbnN0IHJlbW92ZWRWYWx1ZSA9IGN1cnJlbnROb2RlLm5leHQudmFsdWU7XG4gICAgICAgIGN1cnJlbnROb2RlLm5leHQgPSBjdXJyZW50Tm9kZS5uZXh0Lm5leHQ7XG5cbiAgICAgICAgaWYgKCFjdXJyZW50Tm9kZS5uZXh0KSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgcmVtb3ZlZCBub2RlIHdhcyB0aGUgdGFpbCwgdXBkYXRlIHRoZSB0YWlsXG4gICAgICAgICAgICB0aGlzLnRhaWwgPSBjdXJyZW50Tm9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZW1vdmVkVmFsdWU7XG4gICAgfVxufVxuXG4vLyBFeGFtcGxlIHVzYWdlOlxuLy8gY29uc3QgbGlzdCA9IG5ldyBMaW5rZWRMaXN0KCk7XG4vLyBsaXN0LmFwcGVuZCgxKTtcbi8vIGxpc3QuYXBwZW5kKDIpO1xuLy8gbGlzdC5hcHBlbmQoMyk7XG4vLyBsaXN0LnByZXBlbmQoMCk7XG5cbi8vIGxpc3QuaW5zZXJ0QXQoMS41LCAyKTtcbi8vIGNvbnNvbGUubG9nKCdMaW5rZWRMaXN0OicsIGxpc3QudG9TdHJpbmcoKSk7IC8vIE91dHB1dDogKCAwICkgLT4gKCAxICkgLT4gKCAxLjUgKSAtPiAoIDIgKSAtPiAoIDMgKSAtPiBudWxsXG5cbi8vIGxpc3QucmVtb3ZlQXQoMik7XG4vLyBjb25zb2xlLmxvZygnTGlua2VkTGlzdCBhZnRlciByZW1vdmFsOicsIGxpc3QudG9TdHJpbmcoKSk7IC8vIE91dHB1dDogKCAwICkgLT4gKCAxICkgLT4gKCAyICkgLT4gKCAzICkgLT4gbnVsbFxuXG4vLyBsaXN0LnJlbW92ZUF0KDApO1xuLy8gY29uc29sZS5sb2coJ0xpbmtlZExpc3QgYWZ0ZXIgcmVtb3ZpbmcgaGVhZDonLCBsaXN0LnRvU3RyaW5nKCkpOyAvLyBPdXRwdXQ6ICggMSApIC0+ICggMiApIC0+ICggMyApIC0+IG51bGxcblxuLy8gbGlzdC5yZW1vdmVBdCgyKTtcbi8vIGNvbnNvbGUubG9nKCdMaW5rZWRMaXN0IGFmdGVyIHJlbW92aW5nIHRhaWw6JywgbGlzdC50b1N0cmluZygpKTsgLy8gT3V0cHV0OiAoIDEgKSAtPiAoIDIgKSAtPiBudWxsIiwiaW1wb3J0IHsgTGlua2VkTGlzdCwgTm9kZSB9IGZyb20gXCIuL2xpbmtlZExpc3RcIjtcblxuLy9odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUg2MkpmdjFESmxVXG5leHBvcnQgY2xhc3MgSGFzaE1hcCB7XG4gICAgY29uc3RydWN0b3IoY2FwYWNpdHkgPSA4KSB7XG4gICAgICAgIHRoaXMuYnVja2V0cyA9IG5ldyBBcnJheShjYXBhY2l0eSkuZmlsbChudWxsKS5tYXAoKCkgPT4gbmV3IExpbmtlZExpc3QoKSk7IFxuICAgICAgICAvL21hcCgoKSA9PiBuZXcgTGlua2VkTGlzdCgpIFRyYW5zZm9ybXMgZWFjaCBudWxsIHZhbHVlIGludG8gYW4gZW1wdHkgbGlua2VkIGxpc3QuXG4gICAgICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgICAgIHRoaXMubG9hZEZhY3RvciA9IDAuNzU7XG4gICAgfVxuICBcbiAgICAvLyBIYXNoIGZ1bmN0aW9uXG4gICAgaGFzaChrZXkpIHtcbiAgICAgICAgbGV0IGhhc2hDb2RlID0gMDtcbiAgICAgICAgY29uc3QgcHJpbWVOdW1iZXIgPSAzMTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGhhc2hDb2RlID0gKHByaW1lTnVtYmVyICogaGFzaENvZGUgKyBrZXkuY2hhckNvZGVBdChpKSkgJSB0aGlzLmJ1Y2tldHMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoYXNoQ29kZTtcbiAgICB9XG5cbiAgICBzZXQoa2V5LCB2YWx1ZSl7XG4gICAgICAgIGxldCBoYXNoQ29kZSA9IHRoaXMuaGFzaChrZXkpO1xuICAgICAgICBsZXQgYnVja2V0O1xuICAgICAgICBpZiAoaGFzaENvZGUgPCAwIHx8IGhhc2hDb2RlID49IHRoaXMuYnVja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVja2V0ID0gdGhpcy5idWNrZXRzW2hhc2hDb2RlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBrZXkgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGJ1Y2tldFxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudE5vZGUudmFsdWUua2V5ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZS52YWx1ZS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYnVja2V0LmFwcGVuZCh7IGtleSwgdmFsdWUgfSk7XG4gICAgICAgIHRoaXMuc2l6ZSsrO1xuXG4gICAgICAgIC8vIFJlc2l6ZSBpZiBsb2FkIGZhY3RvciBpcyBleGNlZWRlZFxuICAgICAgICBpZiAodGhpcy5zaXplIC8gdGhpcy5idWNrZXRzLmxlbmd0aCA+IHRoaXMubG9hZEZhY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5yZXNpemUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzaXplZCBoYXNobWFwXCIpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQoa2V5KXtcbiAgICAgICAgbGV0IGhhc2hDb2RlID0gdGhpcy5oYXNoKGtleSk7XG4gICAgICAgIGxldCBidWNrZXQ7XG4gICAgICAgIGlmIChoYXNoQ29kZSA8IDAgfHwgaGFzaENvZGUgPj0gdGhpcy5idWNrZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBpbmRleCBvdXQgb2YgYm91bmRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidWNrZXQgPSB0aGlzLmJ1Y2tldHNbaGFzaENvZGVdO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gYnVja2V0LmhlYWQ7XG4gICAgICAgIHdoaWxlIChjdXJyZW50Tm9kZSkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlLnZhbHVlLmtleSA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLnZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFwiTm90IGZvdW5kXCI7XG4gICAgfVxuXG4gICAgaGFzKGtleSl7XG4gICAgICAgIGxldCBoYXNoQ29kZSA9IHRoaXMuaGFzaChrZXkpO1xuICAgICAgICBsZXQgYnVja2V0O1xuICAgICAgICBpZiAoaGFzaENvZGUgPCAwIHx8IGhhc2hDb2RlID49IHRoaXMuYnVja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVja2V0ID0gdGhpcy5idWNrZXRzW2hhc2hDb2RlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IGJ1Y2tldC5oZWFkO1xuICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50Tm9kZS52YWx1ZS5rZXkgPT09IGtleSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZW1vdmUoa2V5KSB7XG4gICAgICAgIGxldCBoYXNoQ29kZSA9IHRoaXMuaGFzaChrZXkpO1xuICAgICAgICBsZXQgYnVja2V0O1xuICAgICAgICBpZiAoaGFzaENvZGUgPCAwIHx8IGhhc2hDb2RlID49IHRoaXMuYnVja2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnVja2V0ID0gdGhpcy5idWNrZXRzW2hhc2hDb2RlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IGJ1Y2tldC5oZWFkO1xuICAgICAgICBsZXQgcHJldmlvdXNOb2RlID0gbnVsbDtcblxuICAgICAgICB3aGlsZShjdXJyZW50Tm9kZSkge1xuICAgICAgICAgICAgaWYoY3VycmVudE5vZGUudmFsdWUua2V5ID09PSBrZXkpe1xuICAgICAgICAgICAgICAgIGlmKHByZXZpb3VzTm9kZSl7XG4gICAgICAgICAgICAgICAgICAgIC8vZGVsZXRlcyBjdXJyZW50IG5vZGUgYnkgYnlwYXNzaW5nIGl0XG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzTm9kZS5uZXh0ID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBidWNrZXQuaGVhZCA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBjdXJyZW50IG5vZGUgaXMgdGhlIHRhaWwsIHVwZGF0ZSB0aGUgdGFpbCByZWZlcmVuY2VcbiAgICAgICAgICAgICAgICBpZihjdXJyZW50Tm9kZSA9PT0gYnVja2V0LnRhaWwpe1xuICAgICAgICAgICAgICAgICAgICBidWNrZXQudGFpbCA9IHByZXZpb3VzTm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5zaXplLS07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnROb2RlLnZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJldmlvdXNOb2RlID0gY3VycmVudE5vZGU7XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy9SZXR1cm5zIHRoZSBudW1iZXIgb2Ygc3RvcmVkIGtleXMgaW4gdGhlIGhhc2ggbWFwXG4gICAgbGVuZ3RoKCl7XG4gICAgICAgIHJldHVybiB0aGlzLnNpemUoKTtcbiAgICB9XG5cbiAgICBjbGVhcigpe1xuICAgICAgICB0aGlzLmJ1Y2tldHMgPSBuZXcgQXJyYXkodGhpcy5idWNrZXRzLmxlbmd0aCkuZmlsbChudWxsKS5tYXAoKCkgPT4gbmV3IExpbmtlZExpc3QoKSk7XG4gICAgICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgfVxuXG4gICAga2V5cygpe1xuICAgICAgICBjb25zdCBrZXlzQXJyYXkgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgYnVja2V0IG9mIHRoaXMuYnVja2V0cyl7XG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBidWNrZXQuaGVhZDtcbiAgICAgICAgICAgIHdoaWxlKGN1cnJlbnROb2RlKXtcbiAgICAgICAgICAgICAgICBrZXlzQXJyYXkucHVzaChjdXJyZW50Tm9kZS52YWx1ZS5rZXkpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ga2V5c0FycmF5O1xuICAgIH1cblxuICAgIHZhbHVlcygpe1xuICAgICAgICBjb25zdCB2YWx1ZXNBcnJheSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBidWNrZXQgb2YgdGhpcy5idWNrZXRzKXtcbiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IGJ1Y2tldC5oZWFkO1xuICAgICAgICAgICAgd2hpbGUoY3VycmVudE5vZGUpe1xuICAgICAgICAgICAgICAgIHZhbHVlc0FycmF5LnB1c2goY3VycmVudE5vZGUudmFsdWUudmFsdWUpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWVzQXJyYXk7XG4gICAgfVxuXG4gICAgZW50cmllcygpIHtcbiAgICAgICAgY29uc3QgZW50cmllc0FycmF5ID0gW107XG4gICAgICAgIGZvciAobGV0IGJ1Y2tldCBvZiB0aGlzLmJ1Y2tldHMpIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IGJ1Y2tldC5oZWFkO1xuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZUFycmF5ID0gW2N1cnJlbnROb2RlLnZhbHVlLmtleSwgY3VycmVudE5vZGUudmFsdWUudmFsdWVdO1xuICAgICAgICAgICAgICAgIGVudHJpZXNBcnJheS5wdXNoKG5vZGVBcnJheSk7XG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbnRyaWVzQXJyYXk7XG4gICAgfVxuICAgIFxuICAgIHJlc2l6ZSgpIHtcbiAgICAgICAgY29uc3QgbmV3Q2FwYWNpdHkgPSB0aGlzLmJ1Y2tldHMubGVuZ3RoICogMjtcbiAgICAgICAgY29uc3QgbmV3QnVja2V0cyA9IG5ldyBBcnJheShuZXdDYXBhY2l0eSkuZmlsbChudWxsKS5tYXAoKCkgPT4gbmV3IExpbmtlZExpc3QoKSk7XG5cbiAgICAgICAgZm9yIChsZXQgYnVja2V0IG9mIHRoaXMuYnVja2V0cykge1xuICAgICAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gYnVja2V0LmhlYWQ7XG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBoYXNoQ29kZSA9IHRoaXMuaGFzaChjdXJyZW50Tm9kZS52YWx1ZS5rZXkpO1xuICAgICAgICAgICAgICAgIG5ld0J1Y2tldHNbaGFzaENvZGVdLmFwcGVuZChjdXJyZW50Tm9kZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5uZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idWNrZXRzID0gbmV3QnVja2V0cztcbiAgICB9XG59IiwiaW1wb3J0IHsgTGlua2VkTGlzdCwgTm9kZSB9IGZyb20gXCIuL2xpbmtlZExpc3RcIjtcbmltcG9ydCB7IEhhc2hNYXAgfSBmcm9tIFwiLi9oYXNoTWFwXCJcbmltcG9ydCB7IHRlc3QgfSBmcm9tIFwiLi90ZXN0XCJcblxuY29uc3QgaGFzaG1hcCA9IG5ldyBIYXNoTWFwKCk7XG5cbmNvbnNvbGUubG9nKGhhc2htYXAuaGFzaChcIllvcmtzaGlyZVwiKSk7XG5jb25zb2xlLmxvZyhoYXNobWFwLmhhc2goXCJZb3Jrc2hpcmVcIikpO1xuY29uc29sZS5sb2coaGFzaG1hcC5oYXNoKFwiQ2VudGVyXCIpKTtcbmNvbnNvbGUubG9nKGhhc2htYXAuaGFzaChcImNlbnRlclwiKSk7XG5jb25zb2xlLmxvZyhoYXNobWFwLmhhc2goXCJDRU5URVJcIikpO1xuXG5oYXNobWFwLnNldChcIkpvZTI0MjM1XCIsIFwiQG1vZ3VzXCIpO1xuY29uc29sZS5sb2coaGFzaG1hcC5nZXQoXCJKb2UyNDIzNVwiKSk7XG5jb25zb2xlLmxvZyhoYXNobWFwLmhhcyhcIkpvZTI0MjM1XCIpKTtcblxudGVzdCgpO1xuXG5cbi8vaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBidWNrZXRzLmxlbmd0aCkge1xuLy8gICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuLy8gfVxuXG4vLyBjbGFzcyBOb2RlIHtcbi8vICAgICBjb25zdHJ1Y3RvcihrZXksIHZhbHVlLCBuZXh0ID0gbnVsbCkge1xuLy8gICAgICAgICB0aGlzLmtleSA9IGtleTtcbi8vICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuLy8gICAgICAgICB0aGlzLm5leHQgPSBuZXh0O1xuLy8gICAgIH1cbi8vIH1cblxuLy9JIGNvdWxkIHByb2JhYmx5IGp1c3QgcmV1c2UgdGhlIGxpbmtlZCBsaXN0IEkgbWFkZSBpbiBodHRwczovL2dpdGh1Yi5jb20vRHJFcGljby9MaW5rZWRMaXN0L2Jsb2IvbWFpbi9zcmMvaW5kZXguanMgb24gYSBzZXBhcmF0ZSBzY3JpcHQgZmlsZSBcbi8vIGNsYXNzIExpbmtlZExpc3Qge1xuLy8gICAgIGNvbnN0cnVjdG9yKCkge1xuLy8gICAgICAgICB0aGlzLmhlYWQgPSBudWxsO1xuLy8gICAgIH1cbiAgXG4gICAgLy8gSW5zZXJ0IGEgbmV3IG5vZGUgb3IgdXBkYXRlIGFuIGV4aXN0aW5nIG5vZGVcbiAgICAvLyBpbnNlcnQoa2V5LCB2YWx1ZSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgbm9kZS52YWx1ZSA9IHZhbHVlOyAvLyBVcGRhdGUgZXhpc3Rpbmcga2V5XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgbm9kZSA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUoa2V5LCB2YWx1ZSwgdGhpcy5oZWFkKTtcbiAgICAvLyAgICAgdGhpcy5oZWFkID0gbmV3Tm9kZTsgLy8gSW5zZXJ0IG5ldyBub2RlIGF0IHRoZSBoZWFkXG4gICAgLy8gfVxuICBcbiAgICAvLyAvLyBGaW5kIGEgbm9kZSBieSBrZXlcbiAgICAvLyBmaW5kKGtleSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuIG5vZGUudmFsdWU7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgICBub2RlID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIHJldHVybiBudWxsO1xuICAgIC8vIH1cbiAgXG4gICAgLy8gLy8gQ2hlY2sgaWYgYSBrZXkgZXhpc3RzXG4gICAgLy8gaGFzKGtleSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAvLyAgICAgICAgIGlmIChub2RlLmtleSA9PT0ga2V5KSB7XG4gICAgLy8gICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgICBub2RlID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICB9XG4gICAgLy8gICAgIHJldHVybiBmYWxzZTtcbiAgICAvLyB9XG4gIFxuICAgIC8vIC8vIFJlbW92ZSBhIG5vZGUgYnkga2V5XG4gICAgLy8gcmVtb3ZlKGtleSkge1xuICAgIC8vICAgICBsZXQgbm9kZSA9IHRoaXMuaGVhZDtcbiAgICAvLyAgICAgbGV0IHByZXYgPSBudWxsO1xuICAgIC8vICAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkge1xuICAgIC8vICAgICAgICAgaWYgKG5vZGUua2V5ID09PSBrZXkpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAocHJldiA9PT0gbnVsbCkge1xuICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLmhlYWQgPSBub2RlLm5leHQ7XG4gICAgLy8gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgcHJldi5uZXh0ID0gbm9kZS5uZXh0O1xuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIHByZXYgPSBub2RlO1xuICAgIC8vICAgICAgICAgbm9kZSA9IG5vZGUubmV4dDtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICByZXR1cm4gZmFsc2U7XG4gICAgLy8gfVxuLy8gfVxuXG4iLCJpbXBvcnQgeyBIYXNoTWFwIH0gZnJvbSBcIi4vaGFzaE1hcFwiIFxuXG5leHBvcnQgZnVuY3Rpb24gdGVzdCgpe1xuICAgIGNvbnN0IHRlc3QgPSBuZXcgSGFzaE1hcCgpXG5cbiAgICB0ZXN0LnNldCgnYXBwbGUnLCAncmVkJylcbiAgICB0ZXN0LnNldCgnYmFuYW5hJywgJ3llbGxvdycpXG4gICAgdGVzdC5zZXQoJ2NhcnJvdCcsICdvcmFuZ2UnKVxuICAgIHRlc3Quc2V0KCdkb2cnLCAnYnJvd24nKVxuICAgIHRlc3Quc2V0KCdlbGVwaGFudCcsICdncmF5JylcbiAgICB0ZXN0LnNldCgnZnJvZycsICdncmVlbicpXG4gICAgdGVzdC5zZXQoJ2Zyb2cnLCAnYmx1ZScpXG4gICAgLy8gdGVzdC5zZXQoJ2dyYXBlJywgJ3B1cnBsZScpXG4gICAgLy8gdGVzdC5zZXQoJ2hhdCcsICdibGFjaycpXG4gICAgLy8gdGVzdC5zZXQoJ2ljZSBjcmVhbScsICd3aGl0ZScpXG4gICAgLy8gdGVzdC5zZXQoJ2phY2tldCcsICdibHVlJylcbiAgICAvLyB0ZXN0LnNldCgna2l0ZScsICdwaW5rJylcbiAgICAvLyB0ZXN0LnNldCgnbGlvbicsICdnb2xkZW4nKVxuXG4gICAgY29uc29sZS5sb2codGVzdC5lbnRyaWVzKCkpO1xufVxuXG4iXSwibmFtZXMiOlsiTm9kZSIsImNvbnN0cnVjdG9yIiwidmFsdWUiLCJ0aGlzIiwibmV4dCIsIkxpbmtlZExpc3QiLCJoZWFkIiwidGFpbCIsImFwcGVuZCIsIm5ld05vZGUiLCJwcmVwZW5kIiwic2l6ZSIsImkiLCJjdXJyZW50Tm9kZSIsImF0IiwiaW5kZXgiLCJwb3AiLCJjb25zb2xlIiwibG9nIiwicG9wcGVkVmFsdWUiLCJjb250YWlucyIsImZpbmQiLCJ0b1N0cmluZyIsIm91dHB1dCIsImluc2VydEF0IiwicmVtb3ZlQXQiLCJyZW1vdmVkVmFsdWUiLCJIYXNoTWFwIiwiY2FwYWNpdHkiLCJidWNrZXRzIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwibG9hZEZhY3RvciIsImhhc2giLCJrZXkiLCJoYXNoQ29kZSIsImxlbmd0aCIsImNoYXJDb2RlQXQiLCJzZXQiLCJidWNrZXQiLCJFcnJvciIsInJlc2l6ZSIsImdldCIsImhhcyIsInJlbW92ZSIsInByZXZpb3VzTm9kZSIsImNsZWFyIiwia2V5cyIsImtleXNBcnJheSIsInB1c2giLCJ2YWx1ZXMiLCJ2YWx1ZXNBcnJheSIsImVudHJpZXMiLCJlbnRyaWVzQXJyYXkiLCJub2RlQXJyYXkiLCJuZXdDYXBhY2l0eSIsIm5ld0J1Y2tldHMiLCJoYXNobWFwIiwidGVzdCJdLCJzb3VyY2VSb290IjoiIn0=